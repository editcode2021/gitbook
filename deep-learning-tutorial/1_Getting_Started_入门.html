
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>1.入门 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="2_Classifying_MNIST_using_LR_逻辑回归进行MNIST分类.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2" data-path="1_Getting_Started_入门.html">
            
                <a href="1_Getting_Started_入门.html">
            
                    
                    1.入门
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="2_Classifying_MNIST_using_LR_逻辑回归进行MNIST分类.html">
            
                <a href="2_Classifying_MNIST_using_LR_逻辑回归进行MNIST分类.html">
            
                    
                    2.逻辑回归进行MNIST分类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="3_Multilayer_Perceptron_多层感知机.html">
            
                <a href="3_Multilayer_Perceptron_多层感知机.html">
            
                    
                    3.多层感知机
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="4_Convoltional_Neural_Networks_LeNet_卷积神经网络.html">
            
                <a href="4_Convoltional_Neural_Networks_LeNet_卷积神经网络.html">
            
                    
                    4.卷积神经网络
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="5_Denoising_Autoencoders_降噪自动编码.html">
            
                <a href="5_Denoising_Autoencoders_降噪自动编码.html">
            
                    
                    5.降噪自动编码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="6_Stacked_Denoising_Autoencoders_层叠降噪自动编码机.html">
            
                <a href="6_Stacked_Denoising_Autoencoders_层叠降噪自动编码机.html">
            
                    
                    6.层叠降噪自动编码机
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="7_Restricted_Boltzmann_Machine_受限波尔兹曼机.html">
            
                <a href="7_Restricted_Boltzmann_Machine_受限波尔兹曼机.html">
            
                    
                    7.受限波尔兹曼机
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >1.入门</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="&#x5165;&#x95E8;&#xFF08;getting-started&#xFF09;">&#x5165;&#x95E8;&#xFF08;Getting Started&#xFF09;</h1>
<p>&#x8FD9;&#x4E2A;&#x6559;&#x7A0B;&#x5E76;&#x4E0D;&#x662F;&#x4E3A;&#x4E86;&#x5DE9;&#x56FA;&#x7814;&#x7A76;&#x751F;&#x6216;&#x8005;&#x672C;&#x79D1;&#x751F;&#x7684;&#x673A;&#x5668;&#x5B66;&#x4E60;&#x8BFE;&#x7A0B;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x786E;&#x5B9E;&#x5BF9;&#x4E00;&#x4E9B;&#x91CD;&#x8981;&#x7684;&#x6982;&#x5FF5;&#xFF08;&#x548C;&#x516C;&#x5F0F;&#xFF09;&#x505A;&#x4E86;&#x7684;&#x5FEB;&#x901F;&#x7684;&#x6982;&#x8FF0;&#xFF0C;&#x6765;&#x786E;&#x4FDD;&#x6211;&#x4EEC;&#x5728;&#x8C08;&#x8BBA;&#x540C;&#x4E2A;&#x6982;&#x5FF5;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x4F60;&#x4E5F;&#x9700;&#x8981;&#x53BB;&#x4E0B;&#x8F7D;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x4EE5;&#x4FBF;&#x53EF;&#x4EE5;&#x8DD1;&#x672A;&#x6765;&#x8BFE;&#x7A0B;&#x7684;&#x6837;&#x4F8B;&#x4EE3;&#x7801;&#x3002;</p>
<h3 id="&#x4E0B;&#x8F7D;">&#x4E0B;&#x8F7D;</h3>
<p> &#x5728;&#x6BCF;&#x4E00;&#x4E2A;&#x5B66;&#x4E60;&#x7B97;&#x6CD5;&#x7684;&#x9875;&#x9762;&#xFF0C;&#x4F60;&#x90FD;&#x9700;&#x8981;&#x53BB;&#x4E0B;&#x8F7D;&#x76F8;&#x5173;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x52A0;&#x5165;&#x4F60;&#x60F3;&#x8981;&#x4E00;&#x6B21;&#x4E0B;&#x8F7D;&#x6240;&#x6709;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x514B;&#x9686;&#x672C;&#x6559;&#x7A0B;&#x7684;git&#x4ED3;&#x5E93;&#x3002;</p>
<pre><code>git clone git://github.com/lisa-lab/DeepLearningTutorials.git
</code></pre><h3 id="&#x6570;&#x636E;&#x96C6;">&#x6570;&#x636E;&#x96C6;</h3>
<h4 id="mnist&#x6570;&#x636E;&#x96C6;mnistpklgz">MNIST&#x6570;&#x636E;&#x96C6;(mnist.pkl.gz)</h4>
<p> <a href="http://yann.lecun.com/exdb/mnist" target="_blank">MNIST</a>&#x662F;&#x4E00;&#x4E2A;&#x5305;&#x542B;60000&#x4E2A;&#x8BAD;&#x7EC3;&#x6837;&#x4F8B;&#x548C;10000&#x4E2A;&#x6D4B;&#x8BD5;&#x6837;&#x4F8B;&#x7684;&#x624B;&#x5199;&#x6570;&#x5B57;&#x56FE;&#x50CF;&#x7684;&#x6570;&#x636E;&#x96C6;&#x3002;&#x5728;&#x8BB8;&#x591A;&#x8BBA;&#x6587;&#xFF0C;&#x5305;&#x62EC;&#x672C;&#x6559;&#x7A0B;&#xFF0C;&#x90FD;&#x5C06;60000&#x4E2A;&#x8BAD;&#x7EC3;&#x6837;&#x4F8B;&#x5206;&#x4E3A;50000&#x4E2A;&#x6837;&#x4F8B;&#x7684;&#x8BAD;&#x7EC3;&#x96C6;&#x548C;10000&#x4E2A;&#x6837;&#x4F8B;&#x7684;&#x9A8C;&#x8BC1;&#x96C6;&#xFF08;&#x4E3A;&#x4E86;&#x8D85;&#x53C2;&#x6570;&#xFF0C;&#x4F8B;&#x5982;&#x5B66;&#x4E60;&#x7387;&#x3001;&#x6A21;&#x578B;&#x5C3A;&#x5BF8;&#x7B49;&#x7B49;&#xFF09;&#x3002;&#x6240;&#x6709;&#x7684;&#x6570;&#x5B57;&#x56FE;&#x50CF;&#x90FD;&#x88AB;&#x5F52;&#x4E00;&#x5316;&#x548C;&#x4E2D;&#x5FC3;&#x5316;&#x4E3A;28<em>28&#x7684;&#x50CF;&#x7D20;&#xFF0C;256&#x4F4D;&#x56FE;&#x7684;&#x7070;&#x5EA6;&#x56FE;&#x3002;
 &#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x5728;Python&#x4E2D;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x5BF9;&#x6570;&#x636E;&#x96C6;&#x8FDB;&#x884C;&#x4E86;&#x5904;&#x7406;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x91CC;<a href="http://deeplearning.net/data/mnist/mnist.pkl.gz" target="_blank">&#x4E0B;&#x8F7D;</a>&#x3002;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x88AB;&#x8868;&#x793A;&#x4E3A;&#x5305;&#x542B;3&#x4E2A;lists&#x7684;tuple&#xFF1A;&#x8BAD;&#x7EC3;&#x96C6;&#x3001;&#x9A8C;&#x8BC1;&#x96C6;&#x548C;&#x6D4B;&#x8BD5;&#x96C6;&#x3002;&#x6BCF;&#x4E2A;lists&#x90FD;&#x662F;&#x90FD;&#x662F;&#x4E24;&#x4E2A;list&#x7684;&#x7EC4;&#x5408;&#xFF0C;&#x4E00;&#x4E2A;list&#x662F;&#x6709;numpy&#x7684;1&#x7EF4;array&#x8868;&#x793A;&#x7684;784&#xFF08;28</em>28&#xFF09;&#x7EF4;&#x7684;0&#xFF5E;1&#xFF08;0&#x662F;&#x9ED1;&#xFF0C;1&#x662F;&#x767D;&#xFF09;&#x7684;float&#x503C;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;list&#x662F;0&#xFF5E;9&#x7684;&#x56FE;&#x50CF;&#x6807;&#x7B7E;&#x3002;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x663E;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x53BB;&#x52A0;&#x8F7D;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x96C6;&#x3002;</p>
<pre><code class="lang-Python"><span class="hljs-keyword">import</span> cPickle, gzip, numpy
<span class="hljs-comment"># Load the dataset</span>
f = gzip.open(<span class="hljs-string">&apos;mnist.pkl.gz&apos;</span>, <span class="hljs-string">&apos;rb&apos;</span>)
train_set, valid_set, test_set = cPickle.load(f)
f.close()
</code></pre>
<p> &#x5F53;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x96C6;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x901A;&#x5E38;&#x5C06;&#x5B83;&#x5206;&#x5272;&#x7EF4;&#x51E0;&#x4E2A;minibatch&#x3002;&#x6211;&#x4EEC;&#x5EFA;&#x8BAE;&#x4F60;&#x5C06;&#x6570;&#x636E;&#x96C6;&#x50A8;&#x5B58;&#x4E3A;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#xFF08;shared variables&#xFF09;&#xFF0C;&#x901A;&#x8FC7;minibatch&#x7684;&#x7D22;&#x5F15;&#xFF08;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x7684;&#x88AB;&#x544A;&#x77E5;&#x7684;batch&#x7684;&#x5C3A;&#x5BF8;&#xFF09;&#x6765;&#x5B58;&#x53D6;&#x5B83;&#x4EEC;&#x3002;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;&#x539F;&#x56E0;&#x662F;&#x4E3A;&#x4E86;&#x4F7F;&#x7528;GPU&#x3002;&#x56E0;&#x4E3A;&#x5F80;GPUX&#x663E;&#x5B58;&#x4E2D;&#x590D;&#x5236;&#x6570;&#x636E;&#x662F;&#x4E00;&#x4E2A;&#x5DE8;&#x5927;&#x7684;&#x5F00;&#x9500;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x4F7F;&#x7528;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#xFF0C;GPU&#x4EE3;&#x7801;&#x7684;&#x8FD0;&#x884C;&#x6548;&#x7387;&#x5C06;&#x4E0D;&#x4F1A;&#x6BD4;CPU&#x4EE3;&#x7801;&#x5FEB;&#x3002;&#x5982;&#x679C;&#x4F60;&#x5C06;&#x81EA;&#x5DF1;&#x7684;&#x6570;&#x636E;&#x5B9A;&#x4E49;&#x4E3A;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#xFF0C;&#x5F53;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x88AB;&#x6784;&#x5EFA;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F60;&#x5C31;&#x7ED9;&#x4E86;Theano&#x5728;&#x4E00;&#x6B21;&#x8BF7;&#x6C42;&#x4E2D;&#x5C06;&#x6574;&#x4E2A;&#x6570;&#x636E;&#x590D;&#x5236;&#x5230;GPU&#x4E0A;&#x7684;&#x53EF;&#x80FD;&#x3002;&#x4E4B;&#x540E;&#xFF0C;GPU&#x5C31;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x7684;slice&#xFF08;&#x5207;&#x7247;&#xFF09;&#x6765;&#x5B58;&#x53D6;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;minibatch&#xFF0C;&#x800C;&#x4E0D;&#x5FC5;&#x518D;&#x4ECE;CPU&#x4E0A;&#x62F7;&#x8D1D;&#x6570;&#x636E;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x56E0;&#x4E3A;&#x6570;&#x636E;&#x5411;&#x91CF;&#xFF08;&#x5B9E;&#x6570;&#xFF09;&#x548C;&#x6807;&#x7B7E;&#xFF08;&#x6574;&#x6570;&#xFF09;&#x901A;&#x5E38;&#x662F;&#x4E0D;&#x540C;&#x5C5E;&#x6027;&#x7684;&#xFF0C;&#x6D4B;&#x8BD5;&#x96C6;&#x3001;&#x9A8C;&#x8BC1;&#x96C6;&#x548C;&#x8BAD;&#x7EC3;&#x96C6;&#x662F;&#x4E0D;&#x540C;&#x76EE;&#x7684;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5EFA;&#x8BAE;&#x901A;&#x8FC7;&#x4E0D;&#x540C;&#x7684;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x6765;&#x50A8;&#x5B58;&#xFF08;&#x8FD9;&#x5C31;&#x4EA7;&#x751F;&#x4E86;6&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#xFF09;&#x3002;
 &#x7531;&#x4E8E;&#x73B0;&#x5728;&#x7684;&#x6570;&#x636E;&#x518D;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x91CC;&#x9762;&#xFF0C;&#x4E00;&#x4E2A;minibatch&#x88AB;&#x5B9A;&#x4E49;&#x4E3A;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x7684;&#x4E00;&#x4E2A;&#x5207;&#x7247;&#x3002;&#x901A;&#x8FC7;&#x6307;&#x5B9A;&#x5B83;&#x7684;&#x7D22;&#x5F15;&#x548C;&#x5B83;&#x7684;&#x5C3A;&#x5BF8;&#xFF0C;&#x53EF;&#x4EE5;&#x66F4;&#x52A0;&#x81EA;&#x7136;&#x7684;&#x6765;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;minibatch&#x3002;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x5C55;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x53BB;&#x5B58;&#x53D6;&#x6570;&#x636E;&#x548C;&#x5982;&#x4F55;&#x5B58;&#x53D6;&#x4E00;&#x4E2A;minibatch&#x3002;</p>
<pre><code class="lang-Python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shared_dataset</span><span class="hljs-params">(data_xy)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot; Function that loads the dataset into shared variables

    The reason we store our dataset in shared variables is to allow
    Theano to copy it into the GPU memory (when code is run on GPU).
    Since copying data into the GPU is slow, copying a minibatch everytime
    is needed (the default behaviour if the data is not in a shared
    variable) would lead to a large decrease in performance.
    &quot;&quot;&quot;</span>
    data_x, data_y = data_xy
    shared_x = theano.shared(numpy.asarray(data_x, dtype=theano.config.floatX))
    shared_y = theano.shared(numpy.asarray(data_y, dtype=theano.config.floatX))
    <span class="hljs-comment"># When storing data on the GPU it has to be stored as floats</span>
    <span class="hljs-comment"># therefore we will store the labels as ``floatX`` as well</span>
    <span class="hljs-comment"># (``shared_y`` does exactly that). But during our computations</span>
    <span class="hljs-comment"># we need them as ints (we use labels as index, and if they are</span>
    <span class="hljs-comment"># floats it doesn&apos;t make sense) therefore instead of returning</span>
    <span class="hljs-comment"># ``shared_y`` we will have to cast it to int. This little hack</span>
    <span class="hljs-comment"># lets us get around this issue</span>
    <span class="hljs-keyword">return</span> shared_x, T.cast(shared_y, <span class="hljs-string">&apos;int32&apos;</span>)
</code></pre>
<p> &#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x4EE5;float&#x7684;&#x5F62;&#x5F0F;&#x88AB;&#x5B58;&#x50A8;&#x5728;GPU&#x4E0A;&#xFF08;<code>dtype</code>&#x88AB;&#x5B9A;&#x4E49;&#x4E3A;<code>theano.confug.floatX</code>&#xFF09;&#x3002;&#x7136;&#x540E;&#x518D;&#x5C06;&#x6807;&#x7B7E;&#x8F6C;&#x6362;&#x4E3A;int&#x578B;&#x3002;
    &#x5982;&#x679C;&#x4F60;&#x518D;GPU&#x4E0A;&#x8DD1;&#x4EE3;&#x7801;&#xFF0C;&#x5E76;&#x4E14;&#x6570;&#x636E;&#x96C6;&#x592A;&#x5927;&#xFF0C;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x5185;&#x5B58;&#x5D29;&#x6E83;&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#xFF0C;&#x4F60;&#x5C31;&#x5E94;&#x5F53;&#x628A;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x4E3A;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x6570;&#x636E;&#x50A8;&#x5B58;&#x4E3A;&#x4E00;&#x4E2A;&#x5145;&#x5206;&#x5C0F;&#x7684;&#x5927;&#x5757;&#xFF08;&#x51E0;&#x4E2A;minibatch&#xFF09;&#x5728;&#x4E00;&#x4E2A;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x91CC;&#x9762;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x8BAD;&#x7EC3;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#x5B83;&#x3002;&#x4E00;&#x65E6;&#x4F60;&#x4F7F;&#x7528;&#x4E86;&#x8FD9;&#x4E2A;&#x5927;&#x5757;&#xFF0C;&#x66F4;&#x65B0;&#x5B83;&#x50A8;&#x5B58;&#x7684;&#x503C;&#x3002;&#x8FD9;&#x5C06;&#x6700;&#x5C0F;&#x5316;CPU&#x548C;GPU&#x7684;&#x5185;&#x5B58;&#x4EA4;&#x6362;&#x3002;</p>
<h3 id="&#x6807;&#x8BB0;">&#x6807;&#x8BB0;</h3>
<h4 id="&#x6570;&#x636E;&#x96C6;&#x6807;&#x8BB0;">&#x6570;&#x636E;&#x96C6;&#x6807;&#x8BB0;</h4>
<p>&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x6570;&#x636E;&#x96C6;&#x4E3A;D,&#x5305;&#x62EC;3&#x4E2A;&#x90E8;&#x5206;&#xFF0C;D_train&#xFF0C;D_valid&#xFF0C;D_test&#x4E09;&#x4E2A;&#x96C6;&#x5408;&#x3002;D&#x5185;&#x6BCF;&#x4E2A;&#x7D22;&#x5F15;&#x90FD;&#x662F;&#x4E00;&#x4E2A;(x,y)&#x5BF9;&#x3002;</p>
<h4 id="&#x6570;&#x5B66;&#x7EA6;&#x5B9A;">&#x6570;&#x5B66;&#x7EA6;&#x5B9A;</h4>
<ul>
<li>W&#xFF1A;&#x5927;&#x5199;&#x5B57;&#x6BCD;&#x8868;&#x793A;&#x77E9;&#x9635;&#xFF08;&#x9664;&#x975E;&#x7279;&#x6B8A;&#x8BF4;&#x660E;&#xFF09;</li>
<li>W(i,j)&#xFF1A;&#x77E9;&#x9635;&#x5185;&#xFF08;i&#xFF0C;j&#xFF09;&#x70B9;&#x7684;&#x6570;&#x636E;</li>
<li>W(i.)&#xFF1A;&#x77E9;&#x9635;&#x7684;&#x4E00;&#x884C;</li>
<li>W(.j)&#xFF1A;&#x77E9;&#x9635;&#x7684;&#x4E00;&#x5217;</li>
<li>b&#xFF1A;&#x5C0F;&#x4E9B;&#x5B57;&#x6BCD;&#x8868;&#x793A;&#x5411;&#x91CF;&#xFF08;&#x9664;&#x975E;&#x7279;&#x6B8A;&#x8BF4;&#x660E;&#xFF09;</li>
<li>b(i)&#xFF1A;&#x5411;&#x91CF;&#x5185;&#x7684;&#xFF08;i&#xFF09;&#x70B9;&#x7684;&#x6570;&#x636E;<h4 id="&#x7B26;&#x53F7;&#x548C;&#x7F29;&#x7565;&#x8BED;&#x8868;">&#x7B26;&#x53F7;&#x548C;&#x7F29;&#x7565;&#x8BED;&#x8868;</h4>
</li>
<li>D&#xFF1A;&#x8F93;&#x5165;&#x7EF4;&#x5EA6;&#x7684;&#x6570;&#x76EE;</li>
<li>D_h(i)&#xFF1A;&#x7B2C;i&#x5C42;&#x4E2A;&#x9690;&#x5C42;&#x7684;&#x8F93;&#x5165;&#x5355;&#x5143;&#x6570;&#x76EE;</li>
<li>L&#xFF1A;&#x6807;&#x7B7E;&#x7684;&#x6570;&#x76EE;</li>
<li>NLL&#xFF1A;&#x8D1F;&#x5BF9;&#x6570;&#x4F3C;&#x7136;&#x51FD;&#x6570;</li>
<li>theta&#xFF1A;&#x7ED9;&#x5B9A;&#x6A21;&#x578B;&#x7684;&#x53C2;&#x6570;&#x96C6;&#x5408;</li>
</ul>
<h4 id="python&#x547D;&#x540D;&#x7A7A;&#x95F4;">Python&#x547D;&#x540D;&#x7A7A;&#x95F4;</h4>
<pre><code class="lang-Python"><span class="hljs-keyword">import</span> theano
<span class="hljs-keyword">import</span> theano.tensor <span class="hljs-keyword">as</span> T
<span class="hljs-keyword">import</span> numpy
</code></pre>
<h3 id="&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x7684;&#x76D1;&#x7763;&#x4F18;&#x5316;&#x5165;&#x95E8;">&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x7684;&#x76D1;&#x7763;&#x4F18;&#x5316;&#x5165;&#x95E8;</h3>
<h4 id="&#x5B66;&#x4E60;&#x4E00;&#x4E2A;&#x5206;&#x7C7B;&#x5668;">&#x5B66;&#x4E60;&#x4E00;&#x4E2A;&#x5206;&#x7C7B;&#x5668;</h4>
<h5 id="0-1&#x635F;&#x5931;&#x51FD;&#x6570;">0-1&#x635F;&#x5931;&#x51FD;&#x6570;</h5>
<p><img src="images/1_0-1_loss_1.png" alt="0-1_loss_1"></p>
<p><img src="images/1_0-1_loss_2.png" alt="0-1_loss_2"></p>
<p><img src="images/1_0-1_loss_3.png" alt="0-1_loss_3"></p>
<pre><code class="lang-Python"><span class="hljs-comment"># zero_one_loss is a Theano variable representing a symbolic</span>
<span class="hljs-comment"># expression of the zero one loss ; to get the actual value this</span>
<span class="hljs-comment"># symbolic expression has to be compiled into a Theano function (see</span>
<span class="hljs-comment"># the Theano tutorial for more details)</span>
zero_one_loss = T.sum(T.neq(T.argmax(p_y_given_x), y))
</code></pre>
<h5 id="&#x8D1F;&#x5BF9;&#x6570;&#x4F3C;&#x7136;&#x635F;&#x5931;&#x51FD;&#x6570;">&#x8D1F;&#x5BF9;&#x6570;&#x4F3C;&#x7136;&#x635F;&#x5931;&#x51FD;&#x6570;</h5>
<p> &#x7531;&#x4E8E;0-1&#x635F;&#x5931;&#x51FD;&#x6570;&#x4E0D;&#x53EF;&#x5FAE;&#x5206;&#xFF0C;&#x5728;&#x5927;&#x578B;&#x6A21;&#x578B;&#x4E2D;&#x5BF9;&#x5B83;&#x4F18;&#x5316;&#x4F1A;&#x9020;&#x6210;&#x5DE8;&#x5927;&#x5F00;&#x9500;&#x3002;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x6700;&#x5927;&#x5316;&#x7ED9;&#x5B9A;&#x6570;&#x636E;&#x6807;&#x7B7E;&#x7684;&#x4F3C;&#x7136;&#x51FD;&#x6570;&#x6765;&#x8BAD;&#x7EC3;&#x6A21;&#x578B;&#x3002;</p>
<p><img src="images/1_negative_log_likelihod_1.png" alt="nll_1"></p>
<p><img src="images/1_negative_log_likelihod_2.png" alt="nll_2"></p>
<p> &#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x901A;&#x5E38;&#x8BF4;&#x6700;&#x5C0F;&#x5316;&#x635F;&#x5931;&#x51FD;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x7ED9;&#x5BF9;&#x6570;&#x4F3C;&#x7136;&#x51FD;&#x6570;&#x6DFB;&#x52A0;&#x8D1F;&#x53F7;&#xFF0C;&#x6765;&#x4F7F;&#x5F97;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6C42;&#x89E3;&#x6700;&#x5C0F;&#x5316;&#x8D1F;&#x5BF9;&#x6570;&#x4F3C;&#x7136;&#x635F;&#x5931;&#x51FD;&#x6570;&#x3002;</p>
<pre><code class="lang-Python"><span class="hljs-comment"># NLL is a symbolic variable ; to get the actual value of NLL, this symbolic</span>
<span class="hljs-comment"># expression has to be compiled into a Theano function (see the Theano</span>
<span class="hljs-comment"># tutorial for more details)</span>
NLL = -T.sum(T.log(p_y_given_x)[T.arange(y.shape[<span class="hljs-number">0</span>]), y])
<span class="hljs-comment"># note on syntax: T.arange(y.shape[0]) is a vector of integers [0,1,2,...,len(y)].</span>
<span class="hljs-comment"># Indexing a matrix M by the two vectors [0,1,...,K], [a,b,...,k] returns the</span>
<span class="hljs-comment"># elements M[0,a], M[1,b], ..., M[K,k] as a vector.  Here, we use this</span>
<span class="hljs-comment"># syntax to retrieve the log-probability of the correct labels, y.</span>
</code></pre>
<h4 id="&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;">&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;</h4>
<p> &#x4EC0;&#x4E48;&#x662F;&#x666E;&#x901A;&#x7684;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#xFF1F;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x7B97;&#x6CD5;&#xFF0C;&#x5229;&#x7528;&#x8D1F;&#x68AF;&#x5EA6;&#x65B9;&#x5411;&#x6765;&#x51B3;&#x5B9A;&#x6BCF;&#x6B21;&#x8FED;&#x4EE3;&#x7684;&#x65B0;&#x7684;&#x641C;&#x7D22;&#x65B9;&#x5411;&#xFF0C;&#x4F7F;&#x5F97;&#x6BCF;&#x6B21;&#x8FED;&#x4EE3;&#x80FD;&#x4F7F;&#x5F85;&#x4F18;&#x5316;&#x7684;&#x76EE;&#x6807;&#x51FD;&#x6570;&#x9010;&#x6B65;&#x51CF;&#x5C0F;&#x3002;
&#x4F2A;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#x6240;&#x793A;&#x3002;</p>
<pre><code class="lang-Python"><span class="hljs-comment"># GRADIENT DESCENT</span>

<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    loss = f(params)
    d_loss_wrt_params = ... <span class="hljs-comment"># compute gradient</span>
    params -= learning_rate * d_loss_wrt_params
    <span class="hljs-keyword">if</span> &lt;stopping condition <span class="hljs-keyword">is</span> met&gt;:
        <span class="hljs-keyword">return</span> params
</code></pre>
<p> &#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x5219;&#x662F;&#x666E;&#x901A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x7684;&#x4F18;&#x5316;&#x3002;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x4E00;&#x90E8;&#x5206;&#x6837;&#x672C;&#x6765;&#x4F18;&#x5316;&#x68AF;&#x5EA6;&#x4EE3;&#x66FF;&#x6240;&#x6709;&#x6837;&#x672C;&#x4F18;&#x5316;&#x68AF;&#x5EA6;&#xFF0C;&#x4ECE;&#x800C;&#x5F97;&#x4EE5;&#x66F4;&#x5FEB;&#x903C;&#x8FD1;&#x7ED3;&#x679C;&#x3002;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x6211;&#x4EEC;&#x4E00;&#x6B21;&#x53EA;&#x7528;&#x4E00;&#x4E2A;&#x6837;&#x672C;&#x6765;&#x8BA1;&#x7B97;&#x68AF;&#x5EA6;&#x3002;</p>
<pre><code class="lang-Python"><span class="hljs-comment"># STOCHASTIC GRADIENT DESCENT</span>
<span class="hljs-keyword">for</span> (x_i,y_i) <span class="hljs-keyword">in</span> training_set:
                            <span class="hljs-comment"># imagine an infinite generator</span>
                            <span class="hljs-comment"># that may repeat examples (if there is only a finite training set)</span>
    loss = f(params, x_i, y_i)
    d_loss_wrt_params = ... <span class="hljs-comment"># compute gradient</span>
    params -= learning_rate * d_loss_wrt_params
    <span class="hljs-keyword">if</span> &lt;stopping condition <span class="hljs-keyword">is</span> met&gt;:
        <span class="hljs-keyword">return</span> params
</code></pre>
<p> &#x6211;&#x4EEC;&#x4E0D;&#x6B62;&#x4E00;&#x6B21;&#x7684;&#x5728;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x4E2D;&#x63D0;&#x53CA;&#x8FD9;&#x4E2A;&#x53D8;&#x4F53;&#x2014;&#x2014;&#x201C;minibatches&#x201D;&#x3002;Minibatch&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x533A;&#x522B;&#x4E0E;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#xFF0C;&#x5728;&#x6BCF;&#x6B21;&#x68AF;&#x5EA6;&#x4F30;&#x8BA1;&#x65F6;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;minibatch&#x7684;&#x6570;&#x636E;&#x3002;&#x8FD9;&#x4E2A;&#x6280;&#x672F;&#x51CF;&#x5C0F;&#x4E86;&#x6BCF;&#x6B21;&#x68AF;&#x5EA6;&#x4F30;&#x8BA1;&#x65F6;&#x7684;&#x65B9;&#x5DEE;&#xFF0C;&#x4E5F;&#x9002;&#x5408;&#x73B0;&#x4EE3;&#x7535;&#x8111;&#x7684;&#x5206;&#x5C42;&#x5185;&#x5B58;&#x6784;&#x67B6;&#x3002;</p>
<pre><code class="lang-Python"><span class="hljs-keyword">for</span> (x_batch,y_batch) <span class="hljs-keyword">in</span> train_batches:
                            <span class="hljs-comment"># imagine an infinite generator</span>
                            <span class="hljs-comment"># that may repeat examples</span>
    loss = f(params, x_batch, y_batch)
    d_loss_wrt_params = ... <span class="hljs-comment"># compute gradient using theano</span>
    params -= learning_rate * d_loss_wrt_params
    <span class="hljs-keyword">if</span> &lt;stopping condition <span class="hljs-keyword">is</span> met&gt;:
        <span class="hljs-keyword">return</span> params
</code></pre>
<p> &#x5728;&#x9009;&#x62E9;minibatch&#x7684;&#x5C3A;&#x5BF8;B&#x65F6;&#x4E2D;&#x6709;&#x4E2A;&#x6743;&#x8861;&#x3002;&#x5F53;&#x5C3A;&#x5BF8;&#x6BD4;&#x8F83;&#x5927;&#x65F6;&#xFF0C;&#x5728;&#x68AF;&#x5EA6;&#x4F30;&#x8BA1;&#x65F6;&#x5C31;&#x8981;&#x82B1;&#x8D39;&#x66F4;&#x591A;&#x65F6;&#x95F4;&#x8BA1;&#x7B97;&#x65B9;&#x5DEE;&#xFF1B;&#x5F53;&#x5C3A;&#x5BF8;&#x6BD4;&#x8F83;&#x5C0F;&#x7684;&#x65F6;&#x5019;&#x5462;&#xFF0C;&#x5C31;&#x8981;&#x8FDB;&#x884C;&#x66F4;&#x591A;&#x7684;&#x8FED;&#x4EE3;&#xFF0C;&#x4E5F;&#x66F4;&#x5BB9;&#x6613;&#x6CE2;&#x52A8;&#x3002;&#x56E0;&#x800C;&#x5C3A;&#x5BF8;&#x7684;&#x9009;&#x62E9;&#x8981;&#x7ED3;&#x5408;&#x6A21;&#x578B;&#x3001;&#x6570;&#x636E;&#x96C6;&#x3001;&#x786C;&#x4EF6;&#x7ED3;&#x6784;&#x7B49;&#xFF0C;&#x4ECE;1&#x5230;&#x51E0;&#x767E;&#x4E0D;&#x7B49;&#x3002;
 &#x4F2A;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#x3002;</p>
<pre><code class="lang-Python"><span class="hljs-comment"># Minibatch Stochastic Gradient Descent</span>

<span class="hljs-comment"># assume loss is a symbolic description of the loss function given</span>
<span class="hljs-comment"># the symbolic variables params (shared variable), x_batch, y_batch;</span>

<span class="hljs-comment"># compute gradient of loss with respect to params</span>
d_loss_wrt_params = T.grad(loss, params)

<span class="hljs-comment"># compile the MSGD step into a theano function</span>
updates = [(params, params - learning_rate * d_loss_wrt_params)]
MSGD = theano.function([x_batch,y_batch], loss, updates=updates)

<span class="hljs-keyword">for</span> (x_batch, y_batch) <span class="hljs-keyword">in</span> train_batches:
    <span class="hljs-comment"># here x_batch and y_batch are elements of train_batches and</span>
    <span class="hljs-comment"># therefore numpy arrays; function MSGD also updates the params</span>
    print(<span class="hljs-string">&apos;Current loss is &apos;</span>, MSGD(x_batch, y_batch))
    <span class="hljs-keyword">if</span> stopping_condition_is_met:
        <span class="hljs-keyword">return</span> params
</code></pre>
<h4 id="&#x6B63;&#x5219;&#x5316;">&#x6B63;&#x5219;&#x5316;</h4>
<p> &#x6B63;&#x5219;&#x5316;&#x662F;&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x5728;MSGD&#x8BAD;&#x7EC3;&#x8FC7;&#x7A0B;&#x4E2D;&#x51FA;&#x73B0;&#x8FC7;&#x62DF;&#x5408;&#x3002;&#x4E3A;&#x4E86;&#x5E94;&#x5BF9;&#x8FC7;&#x62DF;&#x5408;&#xFF0C;&#x6211;&#x4EEC;&#x63D0;&#x51FA;&#x4E86;&#x51E0;&#x4E2A;&#x65B9;&#x6CD5;&#xFF1A;L1/L2&#x6B63;&#x5219;&#x5316;&#x548C;early-stopping&#x3002;</p>
<h5 id="l1l2&#x6B63;&#x5219;&#x5316;">L1/L2&#x6B63;&#x5219;&#x5316;</h5>
<p> L1/L2&#x6B63;&#x5219;&#x5316;&#x5C31;&#x662F;&#x5728;&#x635F;&#x5931;&#x51FD;&#x6570;&#x4E2D;&#x6DFB;&#x52A0;&#x989D;&#x5916;&#x7684;&#x9879;&#xFF0C;&#x7528;&#x4EE5;&#x60E9;&#x7F5A;&#x4E00;&#x5B9A;&#x7684;&#x53C2;&#x6570;&#x7ED3;&#x6784;&#x3002;&#x5BF9;&#x4E8E;L2&#x6B63;&#x5219;&#x5316;&#xFF0C;&#x53C8;&#x88AB;&#x79F0;&#x4E3A;&#x201C;&#x6743;&#x5236;&#x9012;&#x51CF;&#xFF08;weight decay&#xFF09;&#x201D;&#x3002;</p>
<p><img src="images/1_l1_l2_regularization_1.png" alt="l1_l2_regularization_1"></p>
<p><img src="images/1_l1_l2_regularization_2.png" alt="l1_l2_regularization_2"></p>
<p> &#x539F;&#x5219;&#x4E0A;&#x6765;&#x8BF4;&#xFF0C;&#x589E;&#x52A0;&#x4E00;&#x4E2A;&#x6B63;&#x5219;&#x9879;&#xFF0C;&#x53EF;&#x4EE5;&#x5E73;&#x6ED1;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x7F51;&#x7EDC;&#x6620;&#x5C04;&#xFF08;&#x901A;&#x8FC7;&#x60E9;&#x7F5A;&#x5927;&#x7684;&#x53C2;&#x6570;&#x503C;&#xFF0C;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x7F51;&#x7EDC;&#x6A21;&#x578B;&#x7684;&#x975E;&#x7EBF;&#x6027;&#x53C2;&#x6570;&#x6570;&#xFF09;&#x3002;&#x56E0;&#x800C;&#x6700;&#x5C0F;&#x5316;&#x8FD9;&#x4E2A;&#x548C;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5BFB;&#x627E;&#x5230;&#x4E0E;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x6700;&#x8D34;&#x5408;&#x540C;&#x65F6;&#x8303;&#x5316;&#x6027;&#x66F4;&#x597D;&#x7684;&#x6A21;&#x578B;&#x3002;&#x66F4;&#x5177;&#x5965;&#x5361;&#x59C6;&#x5243;&#x5200;&#x539F;&#x5219;&#xFF0C;&#x6700;&#x597D;&#x7684;&#x6A21;&#x578B;&#x603B;&#x662F;&#x6700;&#x7B80;&#x5355;&#x7684;&#x3002;
 &#x5F53;&#x7136;&#xFF0C;&#x4E8B;&#x5B9E;&#x4E0A;&#xFF0C;&#x7B80;&#x5355;&#x6A21;&#x578B;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x610F;&#x5473;&#x7740;&#x597D;&#x7684;&#x6CDB;&#x5316;&#x3002;&#x4F46;&#x4ECE;&#x7ECF;&#x9A8C;&#x4E0A;&#x770B;&#xFF0C;&#x8FD9;&#x4E2A;&#x6B63;&#x5219;&#x5316;&#x65B9;&#x6848;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x6CDB;&#x5316;&#x80FD;&#x529B;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x5BF9;&#x4E8E;&#x5C0F;&#x6570;&#x636E;&#x96C6;&#x800C;&#x8A00;&#x3002;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x6211;&#x4EEC;&#x5206;&#x522B;&#x7ED9;&#x4E24;&#x4E2A;&#x6B63;&#x5219;&#x9879;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x7684;&#x6743;&#x91CD;&#x3002;</p>
<pre><code class="lang-Python"><span class="hljs-comment"># symbolic Theano variable that represents the L1 regularization term</span>
L1  = T.sum(abs(param))

<span class="hljs-comment"># symbolic Theano variable that represents the squared L2 term</span>
L2_sqr = T.sum(param ** <span class="hljs-number">2</span>)

<span class="hljs-comment"># the loss</span>
loss = NLL + lambda_1 * L1 + lambda_2 * L2
</code></pre>
<h5 id="early-stopping">Early-stopping</h5>
<p> Early-stopping&#x901A;&#x8FC7;&#x76D1;&#x63A7;&#x6A21;&#x578B;&#x5728;&#x9A8C;&#x8BC1;&#x96C6;&#x4E0A;&#x7684;&#x8868;&#x73B0;&#x6765;&#x5E94;&#x5BF9;&#x8FC7;&#x62DF;&#x5408;&#x3002;&#x9A8C;&#x8BC1;&#x96C6;&#x662F;&#x4E00;&#x4E2A;&#x6211;&#x4EEC;&#x4ECE;&#x672A;&#x5728;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x4E2D;&#x4F7F;&#x7528;&#xFF0C;&#x4E5F;&#x4E0D;&#x5728;&#x6D4B;&#x8BD5;&#x96C6;&#x7684;&#x6570;&#x636E;&#x96C6;&#x5408;&#xFF0C;&#x5B83;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x4E3A;&#x4E86;&#x6D4B;&#x8BD5;&#x6570;&#x636E;&#x7684;&#x4E00;&#x4E2A;&#x8868;&#x8FBE;&#x3002;&#x5F53;&#x5728;&#x9A8C;&#x8BC1;&#x96C6;&#x4E0A;&#xFF0C;&#x6A21;&#x578B;&#x7684;&#x8868;&#x73B0;&#x4E0D;&#x518D;&#x63D0;&#x9AD8;&#xFF0C;&#x6216;&#x8005;&#x8868;&#x73B0;&#x66F4;&#x5DEE;&#xFF0C;&#x90A3;&#x4E48;&#x542F;&#x53D1;&#x5F0F;&#x7B97;&#x6CD5;&#x5E94;&#x8BE5;&#x653E;&#x5F03;&#x7EE7;&#x7EED;&#x4F18;&#x5316;&#x3002;
 &#x5728;&#x9009;&#x62E9;&#x4F55;&#x65F6;&#x7EC8;&#x6B62;&#x4F18;&#x5316;&#x65B9;&#x9762;&#xFF0C;&#x4E3B;&#x8981;&#x57FA;&#x4E8E;&#x4E3B;&#x89C2;&#x5224;&#x65AD;&#x548C;&#x4E00;&#x4E9B;&#x542F;&#x53D1;&#x5F0F;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4F46;&#x5728;&#x8FD9;&#x4E2A;&#x6559;&#x7A0B;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x51E0;&#x4F55;&#x7EA7;&#x6570;&#x589E;&#x52A0;&#x7684;patience&#x91CF;&#x7684;&#x7B56;&#x7565;&#x3002;</p>
<pre><code class="lang-Python"><span class="hljs-comment"># early-stopping parameters</span>
patience = <span class="hljs-number">5000</span>  <span class="hljs-comment"># look as this many examples regardless</span>
patience_increase = <span class="hljs-number">2</span>     <span class="hljs-comment"># wait this much longer when a new best is</span>
                              <span class="hljs-comment"># found</span>
improvement_threshold = <span class="hljs-number">0.995</span>  <span class="hljs-comment"># a relative improvement of this much is</span>
                               <span class="hljs-comment"># considered significant</span>
validation_frequency = min(n_train_batches, patience/<span class="hljs-number">2</span>)
                              <span class="hljs-comment"># go through this many</span>
                              <span class="hljs-comment"># minibatches before checking the network</span>
                              <span class="hljs-comment"># on the validation set; in this case we</span>
                              <span class="hljs-comment"># check every epoch</span>

best_params = <span class="hljs-keyword">None</span>
best_validation_loss = numpy.inf
test_score = <span class="hljs-number">0.</span>
start_time = time.clock()

done_looping = <span class="hljs-keyword">False</span>
epoch = <span class="hljs-number">0</span>
<span class="hljs-keyword">while</span> (epoch &lt; n_epochs) <span class="hljs-keyword">and</span> (<span class="hljs-keyword">not</span> done_looping):
    <span class="hljs-comment"># Report &quot;1&quot; for first epoch, &quot;n_epochs&quot; for last epoch</span>
    epoch = epoch + <span class="hljs-number">1</span>
    <span class="hljs-keyword">for</span> minibatch_index <span class="hljs-keyword">in</span> xrange(n_train_batches):

        d_loss_wrt_params = ... <span class="hljs-comment"># compute gradient</span>
        params -= learning_rate * d_loss_wrt_params <span class="hljs-comment"># gradient descent</span>

        <span class="hljs-comment"># iteration number. We want it to start at 0.</span>
        iter = (epoch - <span class="hljs-number">1</span>) * n_train_batches + minibatch_index
        <span class="hljs-comment"># note that if we do `iter % validation_frequency` it will be</span>
        <span class="hljs-comment"># true for iter = 0 which we do not want. We want it true for</span>
        <span class="hljs-comment"># iter = validation_frequency - 1.</span>
        <span class="hljs-keyword">if</span> (iter + <span class="hljs-number">1</span>) % validation_frequency == <span class="hljs-number">0</span>:

            this_validation_loss = ... <span class="hljs-comment"># compute zero-one loss on validation set</span>

            <span class="hljs-keyword">if</span> this_validation_loss &lt; best_validation_loss:

                <span class="hljs-comment"># improve patience if loss improvement is good enough</span>
                <span class="hljs-keyword">if</span> this_validation_loss &lt; best_validation_loss * improvement_threshold:

                    patience = max(patience, iter * patience_increase)
                best_params = copy.deepcopy(params)
                best_validation_loss = this_validation_loss

        <span class="hljs-keyword">if</span> patience &lt;= iter:
            done_looping = <span class="hljs-keyword">True</span>
            <span class="hljs-keyword">break</span>

<span class="hljs-comment"># POSTCONDITION:</span>
<span class="hljs-comment"># best_params refers to the best out-of-sample parameters observed during the optimization</span>
</code></pre>
<p> &#x5982;&#x679C;&#x8FC7;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x7684;batch&#x6279;&#x6B21;&#x3002;
    &#x8FD9;&#x4E2A;<code>validation_frequency</code>&#x5E94;&#x8BE5;&#x8981;&#x6BD4;<code>patience</code>&#x66F4;&#x5C0F;&#x3002;&#x8FD9;&#x4E2A;&#x4EE3;&#x7801;&#x5E94;&#x8BE5;&#x81F3;&#x5C11;&#x68C0;&#x67E5;&#x4E86;&#x4E24;&#x6B21;&#xFF0C;&#x5728;&#x4F7F;&#x7528;<code>patience</code>&#x4E4B;&#x524D;&#x3002;&#x8FD9;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x7B49;&#x5F0F;<code>validation_frequency = min( value, patience/2.</code>&#x7684;&#x539F;&#x56E0;&#x3002;
    &#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x66F4;&#x597D;&#x7684;&#x8868;&#x73B0;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x7EDF;&#x8BA1;&#x663E;&#x8457;&#x6027;&#x7684;&#x6D4B;&#x8BD5;&#x6765;&#x4EE3;&#x66FF;&#x7B80;&#x5355;&#x7684;&#x6BD4;&#x8F83;&#x6765;&#x51B3;&#x5B9A;&#x662F;&#x5426;&#x589E;&#x52A0;patient&#x3002;</p>
<h4 id="&#x6D4B;&#x8BD5;">&#x6D4B;&#x8BD5;</h4>
<p> &#x6211;&#x4EEC;&#x4F9D;&#x636E;&#x5728;&#x9A8C;&#x8BC1;&#x96C6;&#x4E0A;&#x8868;&#x73B0;&#x6700;&#x597D;&#x7684;&#x53C2;&#x6570;&#x4F5C;&#x4E3A;&#x6A21;&#x578B;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x53BB;&#x5728;&#x6D4B;&#x8BD5;&#x96C6;&#x4E0A;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#x3002;</p>
<h4 id="&#x603B;&#x7ED3;">&#x603B;&#x7ED3;</h4>
<p> &#x8FD9;&#x662F;&#x5BF9;&#x4F18;&#x5316;&#x7AE0;&#x8282;&#x7684;&#x603B;&#x7ED3;&#x3002;Early-stopping&#x6280;&#x672F;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x5C06;&#x6570;&#x636E;&#x5206;&#x5272;&#x4E3A;&#x8BAD;&#x7EC3;&#x96C6;&#x3001;&#x9A8C;&#x8BC1;&#x96C6;&#x3001;&#x6D4B;&#x8BD5;&#x96C6;&#x3002;&#x6D4B;&#x8BD5;&#x96C6;&#x4F7F;&#x7528;minibatch&#x7684;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x6765;&#x5BF9;&#x76EE;&#x6807;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x903C;&#x8FD1;&#x3002;&#x540C;&#x65F6;&#x5F15;&#x5165;L1/L2&#x6B63;&#x5219;&#x9879;&#x6765;&#x5E94;&#x5BF9;&#x8FC7;&#x62DF;&#x5408;&#x3002;</p>
<h3 id="theanopython&#x6280;&#x5DE7;">Theano/Python&#x6280;&#x5DE7;</h3>
<h4 id="&#x8F7D;&#x5165;&#x548C;&#x4FDD;&#x5B58;&#x6A21;&#x578B;">&#x8F7D;&#x5165;&#x548C;&#x4FDD;&#x5B58;&#x6A21;&#x578B;</h4>
<p> &#x5F53;&#x4F60;&#x505A;&#x5B9E;&#x9A8C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7528;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x7B97;&#x6CD5;&#x53EF;&#x80FD;&#x8981;&#x597D;&#x51E0;&#x4E2A;&#x5C0F;&#x65F6;&#x53BB;&#x53D1;&#x73B0;&#x4E00;&#x4E2A;&#x6700;&#x4F18;&#x89E3;&#x3002;&#x4F60;&#x53EF;&#x80FD;&#x5728;&#x53D1;&#x73B0;&#x89E3;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x60F3;&#x8981;&#x4FDD;&#x5B58;&#x8FD9;&#x4E9B;&#x6743;&#x503C;&#x3002;&#x4F60;&#x4E5F;&#x53EF;&#x80FD;&#x60F3;&#x8981;&#x4FDD;&#x5B58;&#x641C;&#x7D22;&#x8FDB;&#x7A0B;&#x4E2D;&#x5F53;&#x524D;&#x6700;&#x4F18;&#x5316;&#x7684;&#x89E3;&#x3002;</p>
<h5 id="&#x4F7F;&#x7528;pickle&#x5728;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x4E2D;&#x50A8;&#x5B58;numpy&#x7684;ndarrays">&#x4F7F;&#x7528;Pickle&#x5728;&#x5171;&#x4EAB;&#x53D8;&#x91CF;&#x4E2D;&#x50A8;&#x5B58;numpy&#x7684;ndarrays</h5>
<pre><code class="lang-Python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> cPickle
<span class="hljs-meta">&gt;&gt;&gt; </span>save_file = open(<span class="hljs-string">&apos;path&apos;</span>, <span class="hljs-string">&apos;wb&apos;</span>)  <span class="hljs-comment"># this will overwrite current contents</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>cPickle.dump(w.get_value(borrow=<span class="hljs-keyword">True</span>), save_file, <span class="hljs-number">-1</span>)  <span class="hljs-comment"># the -1 is for HIGHEST_PROTOCOL</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>cPickle.dump(v.get_value(borrow=<span class="hljs-keyword">True</span>), save_file, <span class="hljs-number">-1</span>)  <span class="hljs-comment"># .. and it triggers much more efficient</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>cPickle.dump(u.get_value(borrow=<span class="hljs-keyword">True</span>), save_file, <span class="hljs-number">-1</span>)  <span class="hljs-comment"># .. storage than numpy&apos;s default</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>save_file.close()
</code></pre>
<pre><code class="lang-Python"><span class="hljs-meta">&gt;&gt;&gt; </span>save_file = open(<span class="hljs-string">&apos;path&apos;</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>w.set_value(cPickle.load(save_file), borrow=<span class="hljs-keyword">True</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>v.set_value(cPickle.load(save_file), borrow=<span class="hljs-keyword">True</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>u.set_value(cPickle.load(save_file), borrow=<span class="hljs-keyword">True</span>)
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: 简介">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="2_Classifying_MNIST_using_LR_逻辑回归进行MNIST分类.html" class="navigation navigation-next " aria-label="Next page: 2.逻辑回归进行MNIST分类">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"1.入门","level":"1.2","depth":1,"next":{"title":"2.逻辑回归进行MNIST分类","level":"1.3","depth":1,"path":"2_Classifying_MNIST_using_LR_逻辑回归进行MNIST分类.md","ref":"2_Classifying_MNIST_using_LR_逻辑回归进行MNIST分类.md","articles":[]},"previous":{"title":"简介","level":"1.1","depth":1,"path":"README.md","ref":"README.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"1_Getting_Started_入门.md","mtime":"2017-07-12T16:21:46.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-05-10T15:44:26.709Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

